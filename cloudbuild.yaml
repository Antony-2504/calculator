steps:
  # Install nvm and Node.js
  - name: 'gcr.io/cloud-builders/npm'
    entrypoint: 'bash'
    args:
      - '-c'
      - |
        curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.1/install.sh | bash
        export NVM_DIR="/root/.nvm"
        [ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"
        [ -s "$NVM_DIR/bash_completion" ] && \. "$NVM_DIR/bash_completion"
        nvm install 18.17.0
        nvm use 18.17.0

  # Build the ReactJS app
  - name: 'gcr.io/cloud-builders/npm'
    args: ['install']
    dir: '/'  # Set the working directory to the root of your project
  - name: 'gcr.io/cloud-builders/npm'
    args: ['run', 'build']
    dir: '/'  # Set the working directory to the root of your project

  # Copy the build artifact to the VM instance
  - name: 'gcr.io/cloud-builders/gcloud'
    entrypoint: 'bash'
    args:
      - '-c'
      - |
        gcloud compute scp --zone=us-central1-a --recurse /workspace/build/* antonyavanexa@instance-3:/var/test/
